# FEATURE: CONFIG_FEATURE_TAR_CREATE
cnt=0
while(( $cnt<=500 )) 
do
    echo "foo foo" | radamsa --seed ${cnt} > foo.orig
    cp foo.orig foo
    echo "bar " | radamsa --seed ${cnt} > bar.orig
    cp bar.orig bar
    ./tar cf foo.tar foo bar
    echo $? >> result/log_reduced_cf
    rm -f foo bar
    ./tar xf foo.tar
    echo $? >> result/log_reduced_xf  
    cat foo
    cat bar
    diff -q foo.orig foo >> result/log_behavior 
    diff -q bar.orig bar >> result/log_behavior 
  let "cnt++"
done

reduced_hang=`grep -o '124' result/log_reduced_cf | wc -l`
reduced_exc=`grep -Eo '134|139' result/log_reduced_cf | wc -l`
reduced_beh=`grep -o '0' result/log_behavior | wc -l`
echo -e "tar-archives-multiple-files count = 500 \n" >> result/result
echo -e "reduced_bin -cf hang "${reduced_hang}" times (total 500)\n" >> result/result
echo -e "reduced_bin -cf has "${reduced_exc}" exceptions (total 500)\n" >> result/result
echo -e "reduced_bin successfully executed "${reduced_beh}" times (total 1000)\n" >> result/result
rm result/log_reduced_cf

reduced_hang=`grep -o '124' result/log_reduced_xf | wc -l`
reduced_exc=`grep -Eo '134|139' result/log_reduced_xf | wc -l`
echo -e "reduced_bin -xf hang "${reduced_hang}" times\n" >> result/result
echo -e "reduced_bin -xf has "${reduced_exc}" exceptions\n" >> result/result
echo "$(<result/result)"
rm result/log_reduced_xf
rm result/log_behavior


