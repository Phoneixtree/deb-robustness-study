# FEATURE: CONFIG_FEATURE_TAR_FROM
# FEATURE: CONFIG_FEATURE_TAR_CREATE
cnt=0
while(( $cnt<=500 )) 
do
echo "abcd abcd" | radamsa --seed ${cnt} > foo.orig
echo "qwerqwerqwer" | radamsa --seed ${cnt} > bar.orig
echo "" | radamsa --seed ${cnt} > baz.orig
cp foo.orig foo
cp bar.orig bar
cp baz.orig baz
tar cf foo.tar foo bar baz
echo foo >foo.exclude
rm foo bar baz
./tar xf foo.tar foo bar -X foo.exclude
echo $? >> result/log_reduced_xf
test ! -f foo -a -f bar -a ! -f baz
diff -q bar.orig bar >> result/log_behavior
let "cnt++"
done


reduced_hang=`grep -o '124' result/log_reduced_xf | wc -l`
reduced_exc=`grep -Eo '134|139' result/log_reduced_xf | wc -l`
reduced_beh=`grep -o '0' result/log_behavior | wc -l`
echo -e "tar-handles-exclude-and-extract-lists count = 500 \n" >> result/result
echo -e "reduced_bin -xf hang "${reduced_hang}" times (total 500)\n" >> result/result
echo -e "reduced_bin -xf has "${reduced_exc}" exceptions (total 500)\n" >> result/result
echo -e "reduced_bin successfully executed "${reduced_beh}" times (total 500)\n" >> result/result
rm result/log_reduced_xf
rm result/log_behavior



